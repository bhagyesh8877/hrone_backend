# HROne Backend Task ‚Äì FastAPI + MongoDB

A backend system to manage **Products** and **Orders** using FastAPI and MongoDB.

---

## Tech Stack

- **FastAPI**
- **MongoDB** (via `pymongo`)
- **Pydantic** for data validation
- **Render** (or **localhost**) for deployment

---

## Project Structure

![alt text](image.png)

---

## Setup Instructions

### 1. Install Dependencies
```bash
pip install -r requirements.txt
```

### 2. Run the Server Locally
```bash
uvicorn app.main:app --reload
```

### 3. Connect MongoDB
Edit your `app/db.py`:
```python
from pymongo import MongoClient

#Replace Your username, password and cluster name in the following url
client = MongoClient("mongodb+srv://<username>:<password>@cluster.mongodb.net/")

# Include your table name below which consist of two collections named produts and orders.
# In my case it is "task"
db = client["task"] 
```

---

## MongoDB Structure 

###  `products`
```json
{
  "_id": ObjectId,
  "name": "string",
  "description": "string",
  "price": float,
  "sizes": [
    {
      "size": "string",
      "quantity": int
    }
  ]
}

```

### `orders`
```json
{
  "_id": ObjectId,
  "userId": "string",
  "items": [
    {
      "productId": ObjectId,
      "qty": int
    }
  ]
}

```

---

## API Endpoints

> Base URL:
> ```
> https://bhagyesh-backend-task.onrender.com
> ```

---

### POST `/products`
**Create a product**
```javascript
POST /products
{
  "name": "Kurta",
  "description": "red kurta",
  "price": 999.99,
  "sizes": [
    { "size": "XL", "quantity": 5 }
  ]
}
```
**Response:**
```json
{
  "_id": "66a9a1f4e93b8c56f1c0a001",
  "name": "Kurta",
  "description": "red kurta",
  "price": 999.99,
  "sizes": [
    { "size": "XL", "quantity": 5 }
  ]
}
```

---

### GET `/products`
**List all products, you can (filter by name, size, and paginate)**
```
https://bhagyesh-backend-task.onrender.com/products
```
**List Products by Name**
```
https://bhagyesh-backend-task.onrender.com/products?name=shirt
```
**List Products by Size**
```
https://bhagyesh-backend-task.onrender.com/products?size=M
```
**Sample Response:**
```json
{
  "data": [
    {
      "id": "66a9a1f4e93b8c56f1c0a001",
      "name": "Shirt",
      "price": 299.99
    }
  ],
  "page": {
    "next": "5",
    "limit": 5,
    "previous": 0
  }
}
```

---

### POST `/orders`
**Create an order by using the same productId and this _id which is generated by response of create products**
```json
POST /orders
{
  "userId": "user_1",
  "items": [
    {
      "productId": "66a9a1f4e93b8c56f1c0a001",
      "qty": 2
    }
  ]
}
```
**Response:**
```json
{
  "id": "66a9b2a1e93b8c56f1c0b001"
}
```

---

### GET `/orders`
**List  all orders**
```
https://bhagyesh-backend-task.onrender.com/orders

```
**Filter Orders by userId**
```
https://bhagyesh-backend-task.onrender.com/orders?userId=user_1

```
**Paginated Orders (limit + offset)**
```
https://bhagyesh-backend-task.onrender.com/orders?limit=3&offset=0

```
** Sample Response:**
```json
{
  "data": [
    {
      "id": "66a9b2a1e93b8c56f1c0b001",
      "items": [
        {
          "productDetails": {
            "id": "66a9a1f4e93b8c56f1c0a001",
            "name": "Shirt"
          },
          "qty": 2
        }
      ]
    }
  ],
  "page": {
    "next": "5",
    "limit": 5,
    "previous": 0
  }
}
```

---

## üë®‚Äçüíª Author

**Bhagyesh Sunil Chaudhari**  